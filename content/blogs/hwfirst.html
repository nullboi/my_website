---
categories:
- ""
- ""
date: "2017-10-31T22:26:09-05:00"
description: Check the challenge
draft: false
image: pic09.jpg
keywords: ""
slug: hwfirst
title: Homework 1 and Chanllenges
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<pre class="r"><code>knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size=&quot;small&quot;)   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = &quot;center&quot;
)</code></pre>
<div id="where-do-people-drink-the-most-beer-wine-and-spirits" class="section level1">
<h1>Where Do People Drink The Most Beer, Wine And Spirits?</h1>
<p>Back in 2014, <a href="https://fivethirtyeight.com/features/dear-mona-followup-where-do-people-drink-the-most-beer-wine-and-spirits/">fivethiryeight.com</a> published an article on alchohol consumption in different countries. The data <code>drinks</code> is available as part of the <code>fivethirtyeight</code> package. Make sure you have installed the <code>fivethirtyeight</code> package before proceeding.</p>
<pre class="r"><code>library(fivethirtyeight)
data(drinks)


# or download directly
# alcohol_direct &lt;- read_csv(&quot;https://raw.githubusercontent.com/fivethirtyeight/data/master/alcohol-consumption/drinks.csv&quot;)</code></pre>
<p>What are the variable types? Any missing values we should worry about?</p>
<p>The dataset contains five variables, which are devided among three types (logical, numerical and character). There are no missing values.</p>
<pre class="r"><code>glimpse(drinks)</code></pre>
<pre><code>## Rows: 193
## Columns: 5
## $ country                      &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Albania&quot;, &quot;Algeria&quot;, &quot;And…
## $ beer_servings                &lt;int&gt; 0, 89, 25, 245, 217, 102, 193, 21, 261, 2…
## $ spirit_servings              &lt;int&gt; 0, 132, 0, 138, 57, 128, 25, 179, 72, 75,…
## $ wine_servings                &lt;int&gt; 0, 54, 14, 312, 45, 45, 221, 11, 212, 191…
## $ total_litres_of_pure_alcohol &lt;dbl&gt; 0.0, 4.9, 0.7, 12.4, 5.9, 4.9, 8.3, 3.8, …</code></pre>
<pre class="r"><code>skim(drinks)</code></pre>
<table>
<caption>(#tab:glimpse_skim_data)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">drinks</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">193</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">193</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">beer_servings</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">106.16</td>
<td align="right">101.14</td>
<td align="right">0</td>
<td align="right">20.0</td>
<td align="right">76.0</td>
<td align="right">188.0</td>
<td align="right">376.0</td>
<td align="left">▇▃▂▂▁</td>
</tr>
<tr class="even">
<td align="left">spirit_servings</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">80.99</td>
<td align="right">88.28</td>
<td align="right">0</td>
<td align="right">4.0</td>
<td align="right">56.0</td>
<td align="right">128.0</td>
<td align="right">438.0</td>
<td align="left">▇▃▂▁▁</td>
</tr>
<tr class="odd">
<td align="left">wine_servings</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">49.45</td>
<td align="right">79.70</td>
<td align="right">0</td>
<td align="right">1.0</td>
<td align="right">8.0</td>
<td align="right">59.0</td>
<td align="right">370.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">total_litres_of_pure_alcohol</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.72</td>
<td align="right">3.77</td>
<td align="right">0</td>
<td align="right">1.3</td>
<td align="right">4.2</td>
<td align="right">7.2</td>
<td align="right">14.4</td>
<td align="left">▇▃▅▃▁</td>
</tr>
</tbody>
</table>
<p>Make a plot that shows the top 25 beer consuming countries</p>
<pre class="r"><code>drinks %&gt;%
  slice_max(order_by = beer_servings, n=25) %&gt;%
  mutate(country = fct_reorder(country, beer_servings)) %&gt;%
  ggplot(aes(x=beer_servings, y=country))+
  geom_col(fill=&#39;#EBC934&#39;)+
  labs(title = &quot;You like beer? These countries do too!&quot;,
         subtitle = &quot;Top 25 beer consuming countries&quot;,
         x = &quot;Servings per person&quot;, 
         y = &quot;&quot;,
         caption = &quot;Source: https://fivethirtyeight.com/features/dear-mona-followup-where-do-people-drink-the-most-beer-wine-and-spirits/&quot;)+
  NULL</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/beer_plot-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Make a plot that shows the top 25 wine consuming countries</p>
<pre class="r"><code>drinks %&gt;%
  slice_max(order_by = wine_servings, n=25) %&gt;%
  mutate(country = fct_reorder(country, wine_servings)) %&gt;%
  ggplot(aes(x=wine_servings, y=country))+
  geom_col(fill=&#39;#9C0606&#39;)+
  labs(title = &quot;Of course, the French like their wine. \
But what other countries consume most of it?&quot;,
         subtitle = &quot;Top 25 wine consuming countries&quot;,
         x = &quot;Servings per person&quot;, 
         y = &quot;&quot;,
         caption = &quot;Source: https://fivethirtyeight.com/features/dear-mona-followup-where-do-people-drink-the-most-beer-wine-and-spirits/&quot;)+
  NULL</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/wine_plot-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Finally, make a plot that shows the top 25 spirit consuming countries</p>
<pre class="r"><code>drinks %&gt;%
  slice_max(order_by = spirit_servings, n=25) %&gt;%
  mutate(country = fct_reorder(country, spirit_servings)) %&gt;%
  ggplot(aes(x=spirit_servings, y=country))+
  geom_col(fill=&#39;#42069C&#39;)+
  labs(title = &quot;The number one spirit consumer country will surprise you!\
The others, maybe not&quot;,
         subtitle = &quot;Top 25 spirits consuming countries&quot;,
         x = &quot;Servings per person&quot;, 
         y = &quot;&quot;,
         caption = &quot;Source: https://fivethirtyeight.com/features/dear-mona-followup-where-do-people-drink-the-most-beer-wine-and-spirits/&quot;)+
  NULL</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/spirit_plot-1.png" width="648" style="display: block; margin: auto;" />
What can you infer from these plots? Don’t just explain what’s in the graph, but speculate or tell a short story (1-2 paragraphs max).</p>
<blockquote>
<p>The graphs represent the consumption per person of the three different bevarages in the top 25 consuming countries.
They also highlight some strong stereotipes we might have about different countries. For instance, you would be lying if you said that you were not surprised by not seeing Germany as the top 1 country consuming beer! We were surprised as well! In fact, after researching Namibia’s history for a while, we discovered that Namibia was a German colony and went through a series of wars to finally get independent in the late 1990. Drinking beer and alchool was prohibited during this time, so after becoming independent Namibia’s population has adopted beer as a symbol of aparheid and independence.
Having people from France, Italy, and Spain in our study group, we were expecting to see those countries among the top 25 consuming countries of wine. So, no surprise on this end.
Regarding spirit consumption, we all knew how much Russians love spirits, what we did not know was that the average daily intake of alcohol in Grenada is 40.4 grams of pure alcohol: 7 grams higher than the Average intake worldwide.</p>
</blockquote>
</div>
<div id="analysis-of-movies--imdb-dataset" class="section level1">
<h1>Analysis of movies- IMDB dataset</h1>
<p>We will look at a subset sample of movies, taken from the <a href="https://www.kaggle.com/carolzhangdc/imdb-5000-movie-dataset">Kaggle IMDB 5000 movie dataset</a></p>
<pre class="r"><code>movies &lt;- read_csv(here::here(&#39;~/Desktop/MAM assessment/fold/my_website&#39;, &#39;movies.csv&#39;))
glimpse(movies)</code></pre>
<pre><code>## Rows: 2,961
## Columns: 11
## $ title               &lt;chr&gt; &quot;Avatar&quot;, &quot;Titanic&quot;, &quot;Jurassic World&quot;, &quot;The Avenge…
## $ genre               &lt;chr&gt; &quot;Action&quot;, &quot;Drama&quot;, &quot;Action&quot;, &quot;Action&quot;, &quot;Action&quot;, &quot;…
## $ director            &lt;chr&gt; &quot;James Cameron&quot;, &quot;James Cameron&quot;, &quot;Colin Trevorrow…
## $ year                &lt;dbl&gt; 2009, 1997, 2015, 2012, 2008, 1999, 1977, 2015, 20…
## $ duration            &lt;dbl&gt; 178, 194, 124, 173, 152, 136, 125, 141, 164, 93, 1…
## $ gross               &lt;dbl&gt; 7.61e+08, 6.59e+08, 6.52e+08, 6.23e+08, 5.33e+08, …
## $ budget              &lt;dbl&gt; 2.37e+08, 2.00e+08, 1.50e+08, 2.20e+08, 1.85e+08, …
## $ cast_facebook_likes &lt;dbl&gt; 4834, 45223, 8458, 87697, 57802, 37723, 13485, 920…
## $ votes               &lt;dbl&gt; 886204, 793059, 418214, 995415, 1676169, 534658, 9…
## $ reviews             &lt;dbl&gt; 3777, 2843, 1934, 2425, 5312, 3917, 1752, 1752, 35…
## $ rating              &lt;dbl&gt; 7.9, 7.7, 7.0, 8.1, 9.0, 6.5, 8.7, 7.5, 8.5, 7.2, …</code></pre>
<p>Besides the obvious variables of <code>title</code>, <code>genre</code>, <code>director</code>, <code>year</code>, and <code>duration</code>, the rest of the variables are as follows:</p>
<ul>
<li><p><code>gross</code> : The gross earnings in the US box office, not adjusted for inflation</p></li>
<li><p><code>budget</code>: The movie’s budget</p></li>
<li><p><code>cast_facebook_likes</code>: the number of facebook likes cast memebrs received</p></li>
<li><p><code>votes</code>: the number of people who voted for (or rated) the movie in IMDB</p></li>
<li><p><code>reviews</code>: the number of reviews for that movie</p></li>
<li><p><code>rating</code>: IMDB average rating</p></li>
<li><p>Are there any missing values (NAs)? Are all entries distinct or are there duplicate entries?</p></li>
</ul>
<p>There are no missing values in the dataset. There are, however, 54 duplicates (number of rows - number of unique titles).</p>
<ul>
<li>Produce a table with the count of movies by genre, ranked in descending order</li>
</ul>
<pre class="r"><code>table0 &lt;- movies %&gt;% 
  group_by(genre)%&gt;%
  count(sort=TRUE)
table0</code></pre>
<pre><code>## # A tibble: 17 × 2
## # Groups:   genre [17]
##    genre           n
##    &lt;chr&gt;       &lt;int&gt;
##  1 Comedy        848
##  2 Action        738
##  3 Drama         498
##  4 Adventure     288
##  5 Crime         202
##  6 Biography     135
##  7 Horror        131
##  8 Animation      35
##  9 Fantasy        28
## 10 Documentary    25
## 11 Mystery        16
## 12 Sci-Fi          7
## 13 Family          3
## 14 Musical         2
## 15 Romance         2
## 16 Western         2
## 17 Thriller        1</code></pre>
<ul>
<li>Produce a table with the average gross earning and budget (<code>gross</code> and <code>budget</code>) by genre. Calculate a variable <code>return_on_budget</code> which shows how many $ did a movie make at the box office for each $ of its budget. Ranked genres by this <code>return_on_budget</code> in descending order</li>
</ul>
<pre class="r"><code>movies %&gt;% 
  group_by(genre) %&gt;% 
  summarise(mean_gross = mean(gross), mean_budget = mean(budget),
            return_on_budget =mean_gross/mean_budget)  %&gt;% 
  arrange(desc(return_on_budget)) </code></pre>
<pre><code>## # A tibble: 17 × 4
##    genre       mean_gross mean_budget return_on_budget
##    &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;            &lt;dbl&gt;
##  1 Musical      92084000     3189500          28.9    
##  2 Family      149160478.   14833333.         10.1    
##  3 Western      20821884     3465000           6.01   
##  4 Documentary  17353973.    5887852.          2.95   
##  5 Horror       37713738.   13504916.          2.79   
##  6 Fantasy      42408841.   17582143.          2.41   
##  7 Comedy       42630552.   24446319.          1.74   
##  8 Mystery      67533021.   39218750           1.72   
##  9 Animation    98433792.   61701429.          1.60   
## 10 Biography    45201805.   28543696.          1.58   
## 11 Adventure    95794257.   66290069.          1.45   
## 12 Drama        37465371.   26242933.          1.43   
## 13 Crime        37502397.   26596169.          1.41   
## 14 Romance      31264848.   25107500           1.25   
## 15 Action       86583860.   71354888.          1.21   
## 16 Sci-Fi       29788371.   27607143.          1.08   
## 17 Thriller         2468      300000           0.00823</code></pre>
<pre class="r"><code>  NULL</code></pre>
<pre><code>## NULL</code></pre>
<ul>
<li>Produce a table that shows the top 15 directors who have created the highest gross revenue in the box office. Don’t just show the total gross amount, but also the mean, median, and standard deviation per director.</li>
</ul>
<pre class="r"><code>movies %&gt;%
   group_by(director)%&gt;%
  summarise(director_gross=sum(gross), mean(gross), median(gross), max(gross)) %&gt;%
  slice_max(order_by= director_gross, n=15)</code></pre>
<pre><code>## # A tibble: 15 × 5
##    director          director_gross `mean(gross)` `median(gross)` `max(gross)`
##    &lt;chr&gt;                      &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt;        &lt;dbl&gt;
##  1 Steven Spielberg      4014061704    174524422.      164435221     434949459
##  2 Michael Bay           2231242537    171634041.      138396624     402076689
##  3 Tim Burton            2071275480    129454718.       76519172     334185206
##  4 Sam Raimi             2014600898    201460090.      234903076     403706375
##  5 James Cameron         1909725910    318287652.      175562880.    760505847
##  6 Christopher Nolan     1813227576    226653447       196667606.    533316061
##  7 George Lucas          1741418480    348283696       380262555     474544677
##  8 Robert Zemeckis       1619309108    124562239.      100853835     329691196
##  9 Clint Eastwood        1378321100     72543216.       46700000     350123553
## 10 Francis Lawrence      1358501971    271700394.      281666058     424645577
## 11 Ron Howard            1335988092    111332341       101587923     260031035
## 12 Gore Verbinski        1329600995    189942999.      123207194     423032628
## 13 Andrew Adamson        1137446920    284361730       279680930.    436471036
## 14 Shawn Levy            1129750988    102704635.       85463309     250863268
## 15 Ridley Scott          1128857598     80632686.       47775715     228430993</code></pre>
<ul>
<li>Finally, ratings. Produce a table that describes how ratings are distributed by genre. We don’t want just the mean, but also, min, max, median, SD and some kind of a histogram or density graph that visually shows how ratings are distributed.</li>
<li></li>
</ul>
<pre class="r"><code>rating_genre &lt;- movies %&gt;%
  group_by(genre) %&gt;%
  summarise(mean = mean(rating), min = min(rating), max = max(rating), median = median(rating), 
            stdev = StdDev(rating), count= count(genre))%&gt;%
  arrange(desc(mean))
rating_genre</code></pre>
<pre><code>## # A tibble: 17 × 7
##    genre        mean   min   max median stdev[,1] count
##    &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;
##  1 Biography    7.11   4.5   8.9   7.2      0.760   135
##  2 Crime        6.92   4.8   9.3   6.9      0.849   202
##  3 Mystery      6.86   4.6   8.5   6.9      0.882    16
##  4 Musical      6.75   6.3   7.2   6.75     0.636     2
##  5 Drama        6.73   2.1   8.8   6.8      0.917   498
##  6 Documentary  6.66   1.6   8.5   7.4      1.77     25
##  7 Sci-Fi       6.66   5     8.2   6.4      1.09      7
##  8 Animation    6.65   4.5   8     6.9      0.968    35
##  9 Romance      6.65   6.2   7.1   6.65     0.636     2
## 10 Adventure    6.51   2.3   8.6   6.6      1.09    288
## 11 Family       6.5    5.7   7.9   5.9      1.22      3
## 12 Action       6.23   2.1   9     6.3      1.03    738
## 13 Fantasy      6.15   4.3   7.9   6.45     0.959    28
## 14 Comedy       6.11   1.9   8.8   6.2      1.02    848
## 15 Horror       5.83   3.6   8.5   5.9      1.01    131
## 16 Western      5.7    4.1   7.3   5.7      2.26      2
## 17 Thriller     4.8    4.8   4.8   4.8     NA         1</code></pre>
<pre class="r"><code>rating_genre %&gt;%
  ggplot(aes( x= mean, y= fct_reorder(genre, mean))) +
  geom_col(fill =&quot;#42069C&quot;) +
  labs(title = &quot;How are the ratings of different genres of movies distributed? These types of movies always get high scores!&quot;,
         subtitle = &quot;Rating distribution of different genres of movies&quot;,
         x = &quot;Average rating&quot;, 
         y = &quot;&quot;,
         caption = &quot;https://www.kaggle.com/carolzhangdc/imdb-5000-movie-dataset&quot;)+
  NULL</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-5-1.png" width="648" style="display: block; margin: auto;" /></p>
<ul>
<li>Examine the relationship between <code>gross</code> and <code>cast_facebook_likes</code>. Produce a scatterplot and write one sentence discussing whether the number of facebook likes that the cast has received is likely to be a good predictor of how much money a movie will make at the box office. What variable are you going to map to the Y- and X- axes?</li>
</ul>
<pre class="r"><code>skim(movies)</code></pre>
<table>
<caption>(#tab:gross_on_fblikes)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">movies</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">2961</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">title</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">83</td>
<td align="right">0</td>
<td align="right">2907</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">genre</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">director</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">32</td>
<td align="right">0</td>
<td align="right">1366</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table style="width:100%;">
<colgroup>
<col width="18%" />
<col width="9%" />
<col width="12%" />
<col width="8%" />
<col width="8%" />
<col width="6%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.00e+03</td>
<td align="right">9.95e+00</td>
<td align="right">1920.0</td>
<td align="right">2.00e+03</td>
<td align="right">2.00e+03</td>
<td align="right">2.01e+03</td>
<td align="right">2.02e+03</td>
<td align="left">▁▁▁▂▇</td>
</tr>
<tr class="even">
<td align="left">duration</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.10e+02</td>
<td align="right">2.22e+01</td>
<td align="right">37.0</td>
<td align="right">9.50e+01</td>
<td align="right">1.06e+02</td>
<td align="right">1.19e+02</td>
<td align="right">3.30e+02</td>
<td align="left">▃▇▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">gross</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5.81e+07</td>
<td align="right">7.25e+07</td>
<td align="right">703.0</td>
<td align="right">1.23e+07</td>
<td align="right">3.47e+07</td>
<td align="right">7.56e+07</td>
<td align="right">7.61e+08</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">budget</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.06e+07</td>
<td align="right">4.37e+07</td>
<td align="right">218.0</td>
<td align="right">1.10e+07</td>
<td align="right">2.60e+07</td>
<td align="right">5.50e+07</td>
<td align="right">3.00e+08</td>
<td align="left">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">cast_facebook_likes</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.24e+04</td>
<td align="right">2.05e+04</td>
<td align="right">0.0</td>
<td align="right">2.24e+03</td>
<td align="right">4.60e+03</td>
<td align="right">1.69e+04</td>
<td align="right">6.57e+05</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">votes</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.09e+05</td>
<td align="right">1.58e+05</td>
<td align="right">5.0</td>
<td align="right">1.99e+04</td>
<td align="right">5.57e+04</td>
<td align="right">1.33e+05</td>
<td align="right">1.69e+06</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">reviews</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5.03e+02</td>
<td align="right">4.94e+02</td>
<td align="right">2.0</td>
<td align="right">1.99e+02</td>
<td align="right">3.64e+02</td>
<td align="right">6.31e+02</td>
<td align="right">5.31e+03</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">rating</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6.39e+00</td>
<td align="right">1.05e+00</td>
<td align="right">1.6</td>
<td align="right">5.80e+00</td>
<td align="right">6.50e+00</td>
<td align="right">7.10e+00</td>
<td align="right">9.30e+00</td>
<td align="left">▁▁▆▇▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table &lt;- select(movies,c(&quot;gross&quot;,&quot;cast_facebook_likes&quot;))

ggplot(movies, aes(x=gross , y=cast_facebook_likes))+
  geom_point()+
  xlim(0,400000000) +
  ylim(0,200000)+ 
  labs(title = &quot;Is the gross earnings of the movie related to facebook likes?&quot;,
         subtitle = &quot;Relationship between gross earnings and facebook likes&quot;,
         x = &quot;Gross earnings of movies&quot;, 
         y = &quot;The number of facebook likes cast members received&quot;,
         caption = &quot;https://www.kaggle.com/carolzhangdc/imdb-5000-movie-dataset&quot;)+
  geom_smooth(method = &quot;lm&quot;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/gross_on_fblikes-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>The graph does not depict a clear and strong correlation between the number of facebook likes that the cast has received and the gross earnings of the movie. Therefore, we can conclude that it is not a good predictor of how much money a movie will make at the box office.
Furthermore, we plotted the facebook likes with the gross earnings adding a linear regression: as we can see in the graph below, the fitted model is not accurate representation of the data. Sequantally, we cannot conclude anything about the relationship between the two variables.</p>
<pre class="r"><code>ggplot(movies, aes(x=gross, y=cast_facebook_likes)) +
  geom_point()+
  xlim(0, 300000000)+
  ylim(0, 100000)+
  labs(title = &quot;Is the gross earnings of the movie related to facebook likes?&quot;,
         subtitle = &quot;Relationship between gross earnings and facebook likes&quot;,
         x = &quot;Gross earnings of movies&quot;, 
         y = &quot;The number of facebook likes cast members received&quot;,
         caption = &quot;https://www.kaggle.com/carolzhangdc/imdb-5000-movie-dataset&quot;)+
  geom_smooth(method=&#39;lm&#39;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-6-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code>summary(lm(cast_facebook_likes ~ gross, movies))</code></pre>
<pre><code>## 
## Call:
## lm(formula = cast_facebook_likes ~ gross, data = movies)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -49976  -8702  -6337   4699 642763 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 8.89e+03   4.73e+02    18.8   &lt;2e-16 ***
## gross       6.04e-05   5.09e-06    11.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 20100 on 2959 degrees of freedom
## Multiple R-squared:  0.0454, Adjusted R-squared:  0.0451 
## F-statistic:  141 on 1 and 2959 DF,  p-value: &lt;2e-16</code></pre>
<ul>
<li>Examine the relationship between <code>gross</code> and <code>budget</code>. Produce a scatterplot and write one sentence discussing whether budget is likely to be a good predictor of how much money a movie will make at the box office.</li>
</ul>
<pre class="r"><code>ggplot(movies, aes(x=gross , y=budget))+
  geom_point()+
  labs(title = &quot;Is the gross earnings of the movie related to movie budgets?&quot;,
         subtitle = &quot;Relationship between gross earnings and movie budgets&quot;,
         x = &quot;Gross earnings of movies&quot;, 
         y = &quot;The movie&#39;s budget&quot;,
         caption = &quot;https://www.kaggle.com/carolzhangdc/imdb-5000-movie-dataset&quot;)+
  geom_smooth(method= &quot;lm&quot;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/gross_on_budget-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>While the scales of the two variables are extremely different, we can say that the higher the budget, the higher the gross earnings.</p>
<ul>
<li>Examine the relationship between <code>gross</code> and <code>rating</code>. Produce a scatterplot, faceted by <code>genre</code> and discuss whether IMDB ratings are likely to be a good predictor of how much money a movie will make at the box office. Is there anything strange in this dataset?</li>
</ul>
<pre class="r"><code>ggplot(movies, aes(x=gross , y=rating))+
  geom_point()+
  labs(title = &quot;Is the gross earnings of the movie related to movie ratings?&quot;,
         subtitle = &quot;Relationship between gross earnings of movies and movie ratings&quot;,
         x = &quot;Gross earnings of movies&quot;, 
         y = &quot;Movie ratings&quot;,
         caption = &quot;https://www.kaggle.com/carolzhangdc/imdb-5000-movie-dataset&quot;)+
  geom_smooth(method =&quot;lm&quot;)+
  facet_wrap(~genre)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/gross_on_rating-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>The dataset presents some limitations: as we can see from “table0”, there are many genres that are underrepresented in the number of datapoints (Thriller 1, Western 2, Romance 2, Musical 2, Family 3 vs Comedy 848 e.g.). This does not allow to make the same studies/comparisons between the different genres.
To answer the question, we cannot infer a sure relationship between the IMDB ratings and the gross earnings for every genre.
For the ones with enough datapoints, we observe a positive correlation between the ratings and the gross earnings, especially for Action, Horror, Drama, Adventure.</p>
</div>
<div id="returns-of-financial-stocks" class="section level1">
<h1>Returns of financial stocks</h1>
<p>In this task we will try to understand how chosen tickers compare in risk and return.
We chose the following list of tickers from the dataset “nyse.csv” and then compared their performance with the one of SPY:
“KO”: Coca-Cola Company (The)
“ACN”: Accenture plc
“BA”: Boeing Company (The)
“GS”: Goldman Sachs Group, Inc. (The)
“NKE”: Nike, Inc.
“NVO”: Novo Nordisk A/S</p>
<pre class="r"><code>nyse &lt;- read_csv(here::here(&quot;~/Desktop/MAM assessment/fold/my_website&quot;,&quot;nyse.csv&quot;))
skim(nyse)</code></pre>
<table>
<caption>(#tab:load_nyse_data)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">nyse</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">508</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">6</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">symbol</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">508</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">name</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">48</td>
<td align="right">0</td>
<td align="right">505</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ipo_year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">33</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sector</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">21</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">industry</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">62</td>
<td align="right">0</td>
<td align="right">103</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">summary_quote</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">31</td>
<td align="right">34</td>
<td align="right">0</td>
<td align="right">508</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Based on this dataset, create a table and a bar plot that shows the number of companies per sector, in descending order</p>
<pre class="r"><code>companies_per_sector &lt;- nyse  %&gt;%
  group_by(sector)  %&gt;%
  summarise(count=count(sector))  %&gt;%
  arrange(desc(count))

companies_per_sector %&gt;%
  ggplot(aes( x= count, y= fct_reorder(sector, count))) +
  geom_col(fill= &quot;#42069C&quot;) +
  labs(title = &quot;How are the numbers of different sectors of company \
distributed? &quot;,
         subtitle = &quot;Number of companies per sector &quot;,
         x = &quot;Number of companies&quot;, 
         y = &quot;&quot;,
         caption = &quot;https://mam2022.netlify.app/reference/finance_data/&quot;)+
  geom_smooth(method =&quot;lm&quot;)+
 NULL</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/companies_per_sector-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code>myStocks &lt;- c(&quot;KO&quot;,&quot;ACN&quot;,&quot;BA&quot;,&quot;GS&quot;,&quot;NKE&quot;,&quot;NVO&quot;,&quot;SPY&quot; ) %&gt;%
  tq_get(get  = &quot;stock.prices&quot;,
         from = &quot;2011-01-01&quot;,
         to   = &quot;2021-08-31&quot;) %&gt;%
  group_by(symbol) 
  NULL</code></pre>
<pre><code>## NULL</code></pre>
<pre class="r"><code>glimpse(myStocks) # examine the structure of the resulting data frame</code></pre>
<pre><code>## Rows: 18,781
## Columns: 8
## Groups: symbol [7]
## $ symbol   &lt;chr&gt; &quot;KO&quot;, &quot;KO&quot;, &quot;KO&quot;, &quot;KO&quot;, &quot;KO&quot;, &quot;KO&quot;, &quot;KO&quot;, &quot;KO&quot;, &quot;KO&quot;, &quot;KO&quot;, &quot;…
## $ date     &lt;date&gt; 2011-01-03, 2011-01-04, 2011-01-05, 2011-01-06, 2011-01-07, …
## $ open     &lt;dbl&gt; 32.9, 32.5, 31.9, 31.8, 31.4, 31.4, 31.7, 31.6, 31.6, 31.7, 3…
## $ high     &lt;dbl&gt; 32.9, 32.6, 32.0, 31.8, 31.5, 31.6, 31.7, 31.7, 31.9, 31.7, 3…
## $ low      &lt;dbl&gt; 32.6, 31.9, 31.4, 31.4, 31.3, 31.3, 31.3, 31.4, 31.6, 31.5, 3…
## $ close    &lt;dbl&gt; 32.6, 31.9, 31.7, 31.5, 31.5, 31.5, 31.3, 31.5, 31.7, 31.6, 3…
## $ volume   &lt;dbl&gt; 18945600, 27940400, 34379000, 21712400, 16592800, 14904600, 1…
## $ adjusted &lt;dbl&gt; 23.4, 22.9, 22.7, 22.6, 22.5, 22.6, 22.4, 22.6, 22.7, 22.6, 2…</code></pre>
<pre class="r"><code>skim(myStocks)</code></pre>
<table>
<caption>(#tab:get_price_data)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">myStocks</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">18781</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">symbol</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="left">symbol</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="left">ACN</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2011-01-03</td>
<td align="left">2021-08-30</td>
<td align="left">2016-05-03</td>
<td align="right">2683</td>
</tr>
<tr class="even">
<td align="left">date</td>
<td align="left">BA</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2011-01-03</td>
<td align="left">2021-08-30</td>
<td align="left">2016-05-03</td>
<td align="right">2683</td>
</tr>
<tr class="odd">
<td align="left">date</td>
<td align="left">GS</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2011-01-03</td>
<td align="left">2021-08-30</td>
<td align="left">2016-05-03</td>
<td align="right">2683</td>
</tr>
<tr class="even">
<td align="left">date</td>
<td align="left">KO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2011-01-03</td>
<td align="left">2021-08-30</td>
<td align="left">2016-05-03</td>
<td align="right">2683</td>
</tr>
<tr class="odd">
<td align="left">date</td>
<td align="left">NKE</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2011-01-03</td>
<td align="left">2021-08-30</td>
<td align="left">2016-05-03</td>
<td align="right">2683</td>
</tr>
<tr class="even">
<td align="left">date</td>
<td align="left">NVO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2011-01-03</td>
<td align="left">2021-08-30</td>
<td align="left">2016-05-03</td>
<td align="right">2683</td>
</tr>
<tr class="odd">
<td align="left">date</td>
<td align="left">SPY</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2011-01-03</td>
<td align="left">2021-08-30</td>
<td align="left">2016-05-03</td>
<td align="right">2683</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="12%" />
<col width="6%" />
<col width="8%" />
<col width="12%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="left">symbol</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">open</td>
<td align="left">ACN</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.27e+02</td>
<td align="right">6.47e+01</td>
<td align="right">4.81e+01</td>
<td align="right">7.65e+01</td>
<td align="right">1.13e+02</td>
<td align="right">1.64e+02</td>
<td align="right">3.35e+02</td>
<td align="left">▇▅▂▁▁</td>
</tr>
<tr class="even">
<td align="left">open</td>
<td align="left">BA</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.81e+02</td>
<td align="right">1.01e+02</td>
<td align="right">5.75e+01</td>
<td align="right">1.07e+02</td>
<td align="right">1.43e+02</td>
<td align="right">2.42e+02</td>
<td align="right">4.46e+02</td>
<td align="left">▇▅▂▃▁</td>
</tr>
<tr class="odd">
<td align="left">open</td>
<td align="left">GS</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.91e+02</td>
<td align="right">5.85e+01</td>
<td align="right">8.81e+01</td>
<td align="right">1.57e+02</td>
<td align="right">1.87e+02</td>
<td align="right">2.23e+02</td>
<td align="right">4.20e+02</td>
<td align="left">▃▇▃▁▁</td>
</tr>
<tr class="even">
<td align="left">open</td>
<td align="left">KO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.33e+01</td>
<td align="right">6.08e+00</td>
<td align="right">3.12e+01</td>
<td align="right">3.93e+01</td>
<td align="right">4.25e+01</td>
<td align="right">4.64e+01</td>
<td align="right">5.98e+01</td>
<td align="left">▃▇▆▂▂</td>
</tr>
<tr class="odd">
<td align="left">open</td>
<td align="left">NKE</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6.08e+01</td>
<td align="right">3.39e+01</td>
<td align="right">1.88e+01</td>
<td align="right">3.31e+01</td>
<td align="right">5.48e+01</td>
<td align="right">8.02e+01</td>
<td align="right">1.74e+02</td>
<td align="left">▇▇▃▂▁</td>
</tr>
<tr class="even">
<td align="left">open</td>
<td align="left">NVO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.62e+01</td>
<td align="right">1.50e+01</td>
<td align="right">1.92e+01</td>
<td align="right">3.42e+01</td>
<td align="right">4.65e+01</td>
<td align="right">5.50e+01</td>
<td align="right">1.07e+02</td>
<td align="left">▆▇▅▁▁</td>
</tr>
<tr class="odd">
<td align="left">open</td>
<td align="left">SPY</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.29e+02</td>
<td align="right">7.73e+01</td>
<td align="right">1.08e+02</td>
<td align="right">1.69e+02</td>
<td align="right">2.11e+02</td>
<td align="right">2.79e+02</td>
<td align="right">4.51e+02</td>
<td align="left">▆▇▆▂▁</td>
</tr>
<tr class="even">
<td align="left">high</td>
<td align="left">ACN</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.28e+02</td>
<td align="right">6.52e+01</td>
<td align="right">4.85e+01</td>
<td align="right">7.72e+01</td>
<td align="right">1.14e+02</td>
<td align="right">1.66e+02</td>
<td align="right">3.39e+02</td>
<td align="left">▇▅▂▁▁</td>
</tr>
<tr class="odd">
<td align="left">high</td>
<td align="left">BA</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.83e+02</td>
<td align="right">1.02e+02</td>
<td align="right">5.92e+01</td>
<td align="right">1.08e+02</td>
<td align="right">1.44e+02</td>
<td align="right">2.45e+02</td>
<td align="right">4.46e+02</td>
<td align="left">▇▃▂▂▁</td>
</tr>
<tr class="even">
<td align="left">high</td>
<td align="left">GS</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.93e+02</td>
<td align="right">5.90e+01</td>
<td align="right">8.93e+01</td>
<td align="right">1.59e+02</td>
<td align="right">1.88e+02</td>
<td align="right">2.25e+02</td>
<td align="right">4.21e+02</td>
<td align="left">▃▇▃▁▁</td>
</tr>
<tr class="odd">
<td align="left">high</td>
<td align="left">KO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.36e+01</td>
<td align="right">6.12e+00</td>
<td align="right">3.13e+01</td>
<td align="right">3.96e+01</td>
<td align="right">4.28e+01</td>
<td align="right">4.67e+01</td>
<td align="right">6.01e+01</td>
<td align="left">▃▇▆▃▂</td>
</tr>
<tr class="even">
<td align="left">high</td>
<td align="left">NKE</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6.14e+01</td>
<td align="right">3.42e+01</td>
<td align="right">1.91e+01</td>
<td align="right">3.33e+01</td>
<td align="right">5.53e+01</td>
<td align="right">8.12e+01</td>
<td align="right">1.74e+02</td>
<td align="left">▇▇▃▂▁</td>
</tr>
<tr class="odd">
<td align="left">high</td>
<td align="left">NVO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.65e+01</td>
<td align="right">1.51e+01</td>
<td align="right">1.93e+01</td>
<td align="right">3.44e+01</td>
<td align="right">4.68e+01</td>
<td align="right">5.54e+01</td>
<td align="right">1.07e+02</td>
<td align="left">▆▇▅▁▁</td>
</tr>
<tr class="even">
<td align="left">high</td>
<td align="left">SPY</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.30e+02</td>
<td align="right">7.77e+01</td>
<td align="right">1.13e+02</td>
<td align="right">1.69e+02</td>
<td align="right">2.11e+02</td>
<td align="right">2.80e+02</td>
<td align="right">4.53e+02</td>
<td align="left">▆▇▆▂▁</td>
</tr>
<tr class="odd">
<td align="left">low</td>
<td align="left">ACN</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.26e+02</td>
<td align="right">6.42e+01</td>
<td align="right">4.74e+01</td>
<td align="right">7.60e+01</td>
<td align="right">1.12e+02</td>
<td align="right">1.62e+02</td>
<td align="right">3.33e+02</td>
<td align="left">▇▅▂▁▁</td>
</tr>
<tr class="even">
<td align="left">low</td>
<td align="left">BA</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.79e+02</td>
<td align="right">9.93e+01</td>
<td align="right">5.60e+01</td>
<td align="right">1.06e+02</td>
<td align="right">1.41e+02</td>
<td align="right">2.39e+02</td>
<td align="right">4.40e+02</td>
<td align="left">▇▅▂▃▁</td>
</tr>
<tr class="odd">
<td align="left">low</td>
<td align="left">GS</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.90e+02</td>
<td align="right">5.80e+01</td>
<td align="right">8.43e+01</td>
<td align="right">1.55e+02</td>
<td align="right">1.85e+02</td>
<td align="right">2.21e+02</td>
<td align="right">4.13e+02</td>
<td align="left">▃▇▃▁▁</td>
</tr>
<tr class="even">
<td align="left">low</td>
<td align="left">KO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.30e+01</td>
<td align="right">6.03e+00</td>
<td align="right">3.06e+01</td>
<td align="right">3.91e+01</td>
<td align="right">4.22e+01</td>
<td align="right">4.61e+01</td>
<td align="right">5.96e+01</td>
<td align="left">▂▇▆▂▂</td>
</tr>
<tr class="odd">
<td align="left">low</td>
<td align="left">NKE</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6.02e+01</td>
<td align="right">3.35e+01</td>
<td align="right">1.74e+01</td>
<td align="right">3.29e+01</td>
<td align="right">5.45e+01</td>
<td align="right">7.97e+01</td>
<td align="right">1.73e+02</td>
<td align="left">▇▇▃▂▁</td>
</tr>
<tr class="even">
<td align="left">low</td>
<td align="left">NVO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.59e+01</td>
<td align="right">1.49e+01</td>
<td align="right">1.89e+01</td>
<td align="right">3.40e+01</td>
<td align="right">4.62e+01</td>
<td align="right">5.46e+01</td>
<td align="right">1.06e+02</td>
<td align="left">▆▇▅▁▁</td>
</tr>
<tr class="odd">
<td align="left">low</td>
<td align="left">SPY</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.28e+02</td>
<td align="right">7.69e+01</td>
<td align="right">1.07e+02</td>
<td align="right">1.68e+02</td>
<td align="right">2.10e+02</td>
<td align="right">2.78e+02</td>
<td align="right">4.51e+02</td>
<td align="left">▆▇▆▂▁</td>
</tr>
<tr class="even">
<td align="left">close</td>
<td align="left">ACN</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.27e+02</td>
<td align="right">6.48e+01</td>
<td align="right">4.74e+01</td>
<td align="right">7.66e+01</td>
<td align="right">1.13e+02</td>
<td align="right">1.64e+02</td>
<td align="right">3.37e+02</td>
<td align="left">▇▅▂▁▁</td>
</tr>
<tr class="odd">
<td align="left">close</td>
<td align="left">BA</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.81e+02</td>
<td align="right">1.01e+02</td>
<td align="right">5.74e+01</td>
<td align="right">1.07e+02</td>
<td align="right">1.42e+02</td>
<td align="right">2.42e+02</td>
<td align="right">4.41e+02</td>
<td align="left">▇▅▂▃▁</td>
</tr>
<tr class="even">
<td align="left">close</td>
<td align="left">GS</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.91e+02</td>
<td align="right">5.86e+01</td>
<td align="right">8.77e+01</td>
<td align="right">1.57e+02</td>
<td align="right">1.86e+02</td>
<td align="right">2.23e+02</td>
<td align="right">4.20e+02</td>
<td align="left">▃▇▃▁▁</td>
</tr>
<tr class="odd">
<td align="left">close</td>
<td align="left">KO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.33e+01</td>
<td align="right">6.08e+00</td>
<td align="right">3.08e+01</td>
<td align="right">3.93e+01</td>
<td align="right">4.25e+01</td>
<td align="right">4.65e+01</td>
<td align="right">6.01e+01</td>
<td align="left">▂▇▆▃▁</td>
</tr>
<tr class="even">
<td align="left">close</td>
<td align="left">NKE</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6.08e+01</td>
<td align="right">3.39e+01</td>
<td align="right">1.89e+01</td>
<td align="right">3.31e+01</td>
<td align="right">5.49e+01</td>
<td align="right">8.04e+01</td>
<td align="right">1.74e+02</td>
<td align="left">▇▇▃▂▁</td>
</tr>
<tr class="odd">
<td align="left">close</td>
<td align="left">NVO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.63e+01</td>
<td align="right">1.50e+01</td>
<td align="right">1.89e+01</td>
<td align="right">3.42e+01</td>
<td align="right">4.66e+01</td>
<td align="right">5.50e+01</td>
<td align="right">1.07e+02</td>
<td align="left">▆▇▅▁▁</td>
</tr>
<tr class="even">
<td align="left">close</td>
<td align="left">SPY</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.29e+02</td>
<td align="right">7.74e+01</td>
<td align="right">1.10e+02</td>
<td align="right">1.69e+02</td>
<td align="right">2.11e+02</td>
<td align="right">2.79e+02</td>
<td align="right">4.52e+02</td>
<td align="left">▆▇▆▂▁</td>
</tr>
<tr class="odd">
<td align="left">volume</td>
<td align="left">ACN</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.74e+06</td>
<td align="right">2.35e+06</td>
<td align="right">5.28e+05</td>
<td align="right">1.80e+06</td>
<td align="right">2.31e+06</td>
<td align="right">3.08e+06</td>
<td align="right">8.97e+07</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">volume</td>
<td align="left">BA</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.36e+06</td>
<td align="right">9.68e+06</td>
<td align="right">7.89e+05</td>
<td align="right">3.19e+06</td>
<td align="right">4.35e+06</td>
<td align="right">6.62e+06</td>
<td align="right">1.03e+08</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">volume</td>
<td align="left">GS</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3.71e+06</td>
<td align="right">2.11e+06</td>
<td align="right">4.68e+05</td>
<td align="right">2.40e+06</td>
<td align="right">3.13e+06</td>
<td align="right">4.41e+06</td>
<td align="right">2.45e+07</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">volume</td>
<td align="left">KO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.45e+07</td>
<td align="right">6.44e+06</td>
<td align="right">3.00e+06</td>
<td align="right">1.06e+07</td>
<td align="right">1.32e+07</td>
<td align="right">1.66e+07</td>
<td align="right">9.90e+07</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">volume</td>
<td align="left">NKE</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">8.44e+06</td>
<td align="right">5.06e+06</td>
<td align="right">1.82e+06</td>
<td align="right">5.65e+06</td>
<td align="right">7.34e+06</td>
<td align="right">9.58e+06</td>
<td align="right">8.63e+07</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">volume</td>
<td align="left">NVO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.61e+06</td>
<td align="right">1.18e+06</td>
<td align="right">1.94e+05</td>
<td align="right">9.37e+05</td>
<td align="right">1.29e+06</td>
<td align="right">1.88e+06</td>
<td align="right">1.44e+07</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">volume</td>
<td align="left">SPY</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.13e+08</td>
<td align="right">6.69e+07</td>
<td align="right">2.03e+07</td>
<td align="right">6.81e+07</td>
<td align="right">9.62e+07</td>
<td align="right">1.37e+08</td>
<td align="right">7.18e+08</td>
<td align="left">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td align="left">adjusted</td>
<td align="left">ACN</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.19e+02</td>
<td align="right">6.75e+01</td>
<td align="right">3.88e+01</td>
<td align="right">6.57e+01</td>
<td align="right">1.04e+02</td>
<td align="right">1.57e+02</td>
<td align="right">3.37e+02</td>
<td align="left">▇▅▂▁▁</td>
</tr>
<tr class="odd">
<td align="left">adjusted</td>
<td align="left">BA</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.70e+02</td>
<td align="right">1.03e+02</td>
<td align="right">4.67e+01</td>
<td align="right">9.12e+01</td>
<td align="right">1.28e+02</td>
<td align="right">2.40e+02</td>
<td align="right">4.30e+02</td>
<td align="left">▇▃▂▂▁</td>
</tr>
<tr class="even">
<td align="left">adjusted</td>
<td align="left">GS</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1.77e+02</td>
<td align="right">6.14e+01</td>
<td align="right">7.51e+01</td>
<td align="right">1.39e+02</td>
<td align="right">1.69e+02</td>
<td align="right">2.09e+02</td>
<td align="right">4.18e+02</td>
<td align="left">▅▇▃▁▁</td>
</tr>
<tr class="odd">
<td align="left">adjusted</td>
<td align="left">KO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3.70e+01</td>
<td align="right">8.58e+00</td>
<td align="right">2.22e+01</td>
<td align="right">3.06e+01</td>
<td align="right">3.57e+01</td>
<td align="right">4.25e+01</td>
<td align="right">5.70e+01</td>
<td align="left">▅▇▆▃▂</td>
</tr>
<tr class="even">
<td align="left">adjusted</td>
<td align="left">NKE</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5.84e+01</td>
<td align="right">3.45e+01</td>
<td align="right">1.67e+01</td>
<td align="right">3.03e+01</td>
<td align="right">5.19e+01</td>
<td align="right">7.82e+01</td>
<td align="right">1.74e+02</td>
<td align="left">▇▆▃▂▁</td>
</tr>
<tr class="odd">
<td align="left">adjusted</td>
<td align="left">NVO</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4.22e+01</td>
<td align="right">1.60e+01</td>
<td align="right">1.54e+01</td>
<td align="right">2.92e+01</td>
<td align="right">4.22e+01</td>
<td align="right">4.95e+01</td>
<td align="right">1.07e+02</td>
<td align="left">▆▇▂▁▁</td>
</tr>
<tr class="even">
<td align="left">adjusted</td>
<td align="left">SPY</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.12e+02</td>
<td align="right">8.40e+01</td>
<td align="right">9.08e+01</td>
<td align="right">1.45e+02</td>
<td align="right">1.89e+02</td>
<td align="right">2.66e+02</td>
<td align="right">4.52e+02</td>
<td align="left">▇▇▆▂▁</td>
</tr>
</tbody>
</table>
<p>Financial performance analysis depends on returns; If I buy a stock today for 100 and I sell it tomorrow for 101.75, my one-day return, assuming no transaction costs, is 1.75%. So given the adjusted closing prices, our first step is to calculate daily and monthly returns.</p>
<pre class="r"><code>#calculate daily returns
myStocks_returns_daily &lt;- myStocks %&gt;%
  tq_transmute(select     = adjusted, 
               mutate_fun = periodReturn, 
               period     = &quot;daily&quot;, 
               type       = &quot;log&quot;,
               col_rename = &quot;daily_returns&quot;,
               cols = c(nested.col))  

#calculate monthly  returns
myStocks_returns_monthly &lt;- myStocks %&gt;%
  tq_transmute(select     = adjusted, 
               mutate_fun = periodReturn, 
               period     = &quot;monthly&quot;, 
               type       = &quot;arithmetic&quot;,
               col_rename = &quot;monthly_returns&quot;,
               cols = c(nested.col)) 

#calculate yearly returns
myStocks_returns_annual &lt;- myStocks %&gt;%
  group_by(symbol) %&gt;%
  tq_transmute(select     = adjusted, 
               mutate_fun = periodReturn, 
               period     = &quot;yearly&quot;, 
               type       = &quot;arithmetic&quot;,
               col_rename = &quot;yearly_returns&quot;,
               cols = c(nested.col))</code></pre>
<p>Create a table where you summarise monthly returns for each of the stocks and <code>SPY</code>; min, max, median, mean, SD.</p>
<pre class="r"><code>stock_returns_monthly &lt;- myStocks_returns_monthly %&gt;%
  group_by(symbol) %&gt;%
  summarise(min=min(monthly_returns), mix=max(monthly_returns), mean=mean(monthly_returns), stdv= StdDev(monthly_returns))

stock_returns_monthly</code></pre>
<pre><code>## # A tibble: 7 × 5
##   symbol    min    mix    mean stdv[,1]
##   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1 ACN    -0.143 0.158  0.0185    0.0566
## 2 BA     -0.458 0.459  0.0157    0.0948
## 3 GS     -0.230 0.234  0.0115    0.0825
## 4 KO     -0.165 0.0849 0.00774   0.0426
## 5 NKE    -0.189 0.156  0.0191    0.0623
## 6 NVO    -0.172 0.198  0.0157    0.0638
## 7 SPY    -0.125 0.127  0.0123    0.0381</code></pre>
<p>Plot a density plot, using <code>geom_density()</code>, for each of the stocks</p>
<pre class="r"><code>myStocks_returns_monthly  %&gt;%
  ggplot(aes(x=monthly_returns))  +
  geom_density(color=&quot;#42069C&quot;)+
  labs(title = &quot;Monthly returns of each of stock &quot;,
         x = &quot;Monthly returns&quot;, 
         y = &quot;&quot;,
         caption = &quot;https://mam2022.netlify.app/reference/finance_data/&quot;)+
  facet_wrap(~symbol)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/density_monthly_returns-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>What can you infer from this plot? Which stock is the riskiest? The least risky?
&gt;<br />
The sharpness of the curve gives us information of the distribution around the mean of the returns. This inharently represents variance, which is also an indicator of risk.
We can conclude that:
1. The SP500 Index is the least risky since it is also the sharpest bell.
2. The two stocks with the highest volatility and therefore the most risky stocks are Boeing (BA) and Goldman Sachs (GS). We could explain the high volatility in returns of BA by looking at the uncertainty in the air travel industry mostly cause by the global pandemic but also other historical events.</p>
<p>Finally, make a plot that shows the expected monthly return (mean) of a stock on the Y axis and the risk (standard deviation) in the X-axis. Please use <code>ggrepel::geom_text_repel()</code> to label each stock</p>
<pre class="r"><code>stock_returns_monthly %&gt;%
  ggplot(aes(x=stdv, y= mean))+
  geom_point(color=&quot;#42069C&quot;) +
  labs(title = &quot;High return means high risk? See what are outliers!&quot;,
        subtitle = &quot;Relationship between expected monthly return and risk&quot;,
         x = &quot;Monthly returns&quot;, 
         y = &quot;Risk&quot;,
         caption = &quot;https://mam2022.netlify.app/reference/finance_data/&quot;)+
  ggrepel::geom_text_repel(aes(label = symbol),
                     nudge_x = 0,
                     na.rm = TRUE)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/risk_return_plot-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>What can you infer from this plot? Are there any stocks which, while being riskier, do not have a higher expected return?</p>
<blockquote>
<p>We would expect to see an ideal investment with high returns and a relatively low risk at the top left corner of this graph.
The different points that we obtained allow us to visually compare the selected stocks in terms of risk and return. Looking at the graph, it becomes clear that some stocks are riskier but do not have higher expected returns compared to the peers; This is the case of GS and BA. We find GS to be a particular poor investment compared to the others since it has the second highest risk while having only the second lowest expected return.</p>
</blockquote>
</div>
<div id="on-your-own-ibm-hr-analytics" class="section level1">
<h1>On your own: IBM HR Analytics</h1>
<div id="ibm-hr-dataset" class="section level2">
<h2>IBM HR Dataset</h2>
<div id="description-of-key-statistics" class="section level3">
<h3>Description of key statistics</h3>
<p>This data set is a fictional dataset created by IBM data scientists. It provides data on key human resources variables, such as income, age, education, gender, attrition and others. The dataset contains 1470 observations for 19 variables, and it has no missing values. We will deep dive into some key statistics to better understand the fictional IBM Workplace.</p>
<p>Firstly we will look into attrition, which refers to the percentage of people within the dataset that have left the country. Out of the whole dataset, 237 employees left the company, which results in an attrition of 16.1%.The age distribution for people who left the company can be seen in Figure 1. If we compare this distribution to the close to normal age distribution of the whole company in Figure 2, we see that they clearly differ. Younger and older employees are most likely to leave, as the percentage of leavers for those age groups is higher than their percentage of total employees.</p>
<pre class="r"><code>hr_dataset &lt;- read_csv(here::here(&quot;~/Desktop/am01/data&quot;, &quot;datasets_1067_1925_WA_Fn-UseC_-HR-Employee-Attrition.csv&quot;))
#glimpse(hr_dataset)</code></pre>
<pre class="r"><code>hr_cleaned &lt;- hr_dataset %&gt;% 
  clean_names() %&gt;% 
  mutate(
    education = case_when(
      education == 1 ~ &quot;Below College&quot;,
      education == 2 ~ &quot;College&quot;,
      education == 3 ~ &quot;Bachelor&quot;,
      education == 4 ~ &quot;Master&quot;,
      education == 5 ~ &quot;Doctor&quot;
    ),
    environment_satisfaction = case_when(
      environment_satisfaction == 1 ~ &quot;Low&quot;,
      environment_satisfaction == 2 ~ &quot;Medium&quot;,
      environment_satisfaction == 3 ~ &quot;High&quot;,
      environment_satisfaction == 4 ~ &quot;Very High&quot;
    ),
    job_satisfaction = case_when(
      job_satisfaction == 1 ~ &quot;Low&quot;,
      job_satisfaction == 2 ~ &quot;Medium&quot;,
      job_satisfaction == 3 ~ &quot;High&quot;,
      job_satisfaction == 4 ~ &quot;Very High&quot;
    ),
    performance_rating = case_when(
      performance_rating == 1 ~ &quot;Low&quot;,
      performance_rating == 2 ~ &quot;Good&quot;,
      performance_rating == 3 ~ &quot;Excellent&quot;,
      performance_rating == 4 ~ &quot;Outstanding&quot;
    ),
    work_life_balance = case_when(
      work_life_balance == 1 ~ &quot;Bad&quot;,
      work_life_balance == 2 ~ &quot;Good&quot;,
      work_life_balance == 3 ~ &quot;Better&quot;,
      work_life_balance == 4 ~ &quot;Best&quot;
    )
  ) %&gt;% 
  select(age, attrition, daily_rate, department,
         distance_from_home, education,
         gender, job_role,environment_satisfaction,
         job_satisfaction, marital_status,
         monthly_income, num_companies_worked, percent_salary_hike,
         performance_rating, total_working_years,
         work_life_balance, years_at_company,
         years_since_last_promotion)</code></pre>
<pre class="r"><code>number_of_attrition &lt;- hr_cleaned  %&gt;% 
  filter(attrition == &quot;Yes&quot;)

number_of_attrition%&gt;%
  ggplot(aes(x=age, y=count(age)))+
  geom_col(fill=&quot;#42069C&quot;)

number_of_attrition=number_of_attrition%&gt;%
  count()

total_number &lt;- hr_cleaned %&gt;% 
  count()

#the relative rate of attrition would be 
attrition = number_of_attrition/ total_number

#age
hr_cleaned%&gt;%
  ggplot(aes(x=age)) +
  geom_bar(fill=&quot;#42069C&quot;)+
  labs(title = &quot;The distribution of employee age&quot;,
       x = &quot;Age&quot;, 
       y = &quot;Count&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-9-1.png" width="40%" style="display: block; margin: auto;" /><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-9-2.png" width="40%" style="display: block; margin: auto;" /></p>
<p>Some other key variable distributions can be observed in the figures below, all right-skewed. Years since last promotion shows almost exponential distribution tendency, with most employees receiving a promotion within the last year. There seems to be a big drop in employees with more than 10 years working at the company, and most employees make between USD 9k and USD 1k per month.</p>
<pre class="r"><code>#years_at_company
hr_cleaned%&gt;%
  ggplot(aes(x=years_at_company))+
  geom_bar(fill=&quot;#42069C&quot;) +
  labs(title = &quot;The distribution of employee&#39;s tenure&quot;,
       x = &quot;Employee tenure&quot;, 
       y = &quot;Count&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)

#monthly_income is continuous variable so we do density
hr_cleaned%&gt;%
  ggplot(aes(x=monthly_income))+
  geom_density(fill=&quot;#42069C&quot;) +
  labs(title = &quot;The density of employee&#39;s monthly income&quot;,
       x = &quot;Monthly income of employees&quot;, 
       y = &quot;&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)


#years_since_last_promotion
hr_cleaned%&gt;%
  ggplot(aes(x=years_since_last_promotion))+
  geom_bar(fill=&quot;#42069C&quot;) +
  labs(title = &quot;The distribution of years since the last promotion&quot;,
       x = &quot;Years since last promotion&quot;, 
       y = &quot;Count&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-10-1.png" width="40%" style="display: block; margin: auto;" /><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-10-2.png" width="40%" style="display: block; margin: auto;" /><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-10-3.png" width="40%" style="display: block; margin: auto;" /></p>
<p>With regards to employees’ wellness, over 60% of them reported high or very high job satisfaction, while most people report a better state of work-life balance. When we look at the performance between groups of employees that report different satisfaction and balance, there does not seem to be a difference in the proportion of employees that score outstanding, or excellent(CHECK PERCENTAGES).</p>
<pre class="r"><code>hr_cleaned%&gt;%
  group_by(job_satisfaction)%&gt;%
  summarise(percentage = count(job_satisfaction))%&gt;%
  mutate(percentage = percentage/sum(percentage)*100)%&gt;%
  ggplot(aes(x=job_satisfaction, y = percentage))+
  geom_col(fill=&quot;#42069C&quot;)+
  labs(title = &quot;The distribution of different job satisfaction level&quot;,
       x = &quot;Job satisfaction&quot;, 
       y = &quot;Percentage&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)
  

hr_cleaned%&gt;%
  group_by(performance_rating)%&gt;%
  ggplot(aes(x=performance_rating, y=job_satisfaction))+
  geom_col(fill=&quot;#42069C&quot;)+
  facet_wrap(~job_satisfaction)+
  labs(title = &quot;The relationship between job satisfaction and perfomance&quot;,
       x = &quot;Job satisfaction&quot;, 
       y = &quot;&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)

hr_cleaned%&gt;%
  group_by(work_life_balance)%&gt;%
  summarise(percentage = count(work_life_balance))%&gt;%
  mutate(percentage = percentage/sum(percentage)*100)%&gt;%
  ggplot(aes(x=work_life_balance, y = percentage))+
  geom_col(fill=&quot;#42069C&quot;)+
  labs(title = &quot;The distribution of different work-life balance level&quot;,
       x = &quot;Work-life balance&quot;, 
       y = &quot;Percentage&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)
  

hr_cleaned%&gt;%
  group_by(performance_rating)%&gt;%
  ggplot(aes(x=performance_rating, y=work_life_balance))+
  geom_col(fill=&quot;#42069C&quot;)+
  facet_wrap(~work_life_balance)+
  labs(title = &quot;The relationship between work-life balance and\
performance&quot;,
       x = &quot;Performance&quot;, 
       y = &quot;&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-11-1.png" width="40%" style="display: block; margin: auto;" /><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-11-2.png" width="40%" style="display: block; margin: auto;" /><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-11-3.png" width="40%" style="display: block; margin: auto;" /><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-11-4.png" width="40%" style="display: block; margin: auto;" /></p>
<p>From the plot of gender vs monthly income we see that for women, monthly income is around USD 6500 while for men it stands at USD 6250. So it’s clear that there is some income difference between females and males but it is almost negligible (USD 250). Monthly income varies directly with the education of employees. So employees with a doctorate are generally paid the highest monthly income.</p>
<pre class="r"><code>hr_cleaned%&gt;%
  group_by(education)%&gt;%
  summarise(monthly_income=mean(monthly_income))%&gt;%
  ggplot(aes(x=monthly_income, y=fct_reorder(education, monthly_income)))+
  geom_col(fill = &quot;#42069C&quot;)  +
  labs(title = &quot;The relationship between monthly income and education&quot;,
       x = &quot;Monthly income&quot;, 
       y = &quot;&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)

hr_cleaned%&gt;%
  group_by(gender)%&gt;%
  summarise(monthly_income=mean(monthly_income))%&gt;%
  ggplot(aes(x=monthly_income, y=fct_reorder(gender, monthly_income)))+
  geom_col(fill = &quot;#42069C&quot;)+
  labs(title = &quot;The relationship between monthly income and gender&quot;,
       x = &quot;Monthly income&quot;, 
       y = &quot;&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-12-1.png" width="40%" style="display: block; margin: auto;" /><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-12-2.png" width="40%" style="display: block; margin: auto;" /></p>
<p>Employees with managerial roles are generally paid higher income, compared to the others, owing to the importance of their roles and the amount of responsibility they hold.</p>
<pre class="r"><code>hr_cleaned %&gt;%
  arrange(desc(monthly_income))%&gt;%
  ggplot(aes(x=monthly_income, y=fct_reorder(job_role, monthly_income)))+
  geom_boxplot(color = &quot;#42069C&quot;) +
  labs(title = &quot;The relationship between monthly income and job\
roles&quot;,
       x = &quot;Monthly income&quot;, 
       y = &quot;&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-13-1.png" width="40%" style="display: block; margin: auto;" />
Monthly income generally increases with age, except for the sales representative and laboratory technicians. This could be because, with more experience, the employees can move to the roles with more responsibility which leads to higher monthly income. For sales representatives and Lab technicians, income increase is almost negligible with age. This could be because, for these roles, more work experience doesn’t necessarily guarantee more skills learnt for them to move to better-paying roles.</p>
<pre class="r"><code>hr_cleaned %&gt;%
  #arrange(desc(monthly_income))%&gt;%
  ggplot(aes( x= age, y= monthly_income))+ facet_wrap(vars(job_role))+
  geom_point(color=&quot;#42069C&quot;)+ geom_smooth(method=&quot;lm&quot;)+
  labs(title = &quot;Monthly income by age for different positions&quot;,
       x = &quot;Age&quot;, 
       y = &quot;Monthly income&quot;,
       caption = &quot;https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset&quot;)</code></pre>
<p><img src="/blogs/hwfirst_files/figure-html/unnamed-chunk-14-1.png" width="40%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
